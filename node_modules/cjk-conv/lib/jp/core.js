"use strict";
/**
 * Created by user on 2017/12/24/024.
 *
 * this module only do the char is exists in jp, zht, zhs
 * so don't use this module when u wanna fully zht <=> zhs
 *
 * 目前只支援 簡繁日漢字 並非全 cjk 漢字支援
 */
Object.defineProperty(exports, "__esModule", { value: true });
const util_1 = require("../util");
const table_1 = require("./table");
exports.ZHJP_TABLE = table_1.default;
exports.ZHJP_TABLE_SAFE = table_1.TABLE_SAFE;
const cjk_conv_1 = require("regexp-helper/lib/cjk-conv");
exports.KEY_JP = 'jp';
exports.KEY_ZHT = 'zht';
exports.KEY_ZHS = 'zhs';
let inited = false;
exports.defaultOptions = {
    safe: true,
};
// /[\u4E00-\u9FFF\u{20000}-\u{2FA1F}]+/u
const REGEXP_TEST = new RegExp(cjk_conv_1._re_cjk_conv('u').source + '+', 'u');
var _;
(function (_) {
    init();
    let langs = Object.keys(exports.TABLE);
    langs.forEach(function (from) {
        langs.forEach(function (to) {
            if (from == to)
                return;
            _[`${from}2${to}`] = function (str, options) {
                if (!REGEXP_TEST.test(str.toString())) {
                    return str;
                }
                options = Object.assign({}, exports.defaultOptions, options);
                return util_1.split(str)
                    .map(function (char) {
                    if (options.skip && options.skip.indexOf(char) != -1) {
                        return char;
                    }
                    let c;
                    if (c = _getdata(char, from, to, options.safe)) {
                        return c;
                    }
                    return char;
                })
                    .join('');
            };
        });
    });
})(_ || (_ = {}));
/**
 * only 只將 日文漢字 => 轉為繁漢字
 * @type {IFrom2To}
 */
exports.jp2zht = _.jp2zht;
/**
 * only 只將 日文漢字 => 轉為簡漢字
 * @type {IFrom2To}
 */
exports.jp2zhs = _.jp2zhs;
/**
 * only 簡漢字 => 轉為日漢字
 * @type {IFrom2To}
 */
exports.zhs2jp = _.zhs2jp;
/**
 * only 只將 繁漢字 => 轉為日文漢字
 * @type {IFrom2To}
 */
exports.zht2jp = _.zht2jp;
/**
 * only 只將簡繁日 當中共通的 繁漢字 => 轉為簡漢字
 * 請勿作為簡繁轉換用
 * @type {IFrom2To}
 */
exports.zht2zhs = _.zht2zhs;
/**
 * only 只將簡繁日 當中共通的 簡漢字 => 轉為繁漢字
 * 請勿作為簡繁轉換用
 * @type {IFrom2To}
 */
exports.zhs2zht = _.zhs2zht;
/**
 * only 只將簡繁日 當中共通的 簡繁漢字 => 轉為日文漢字
 *
 * @alias cjk2jp
 *
 * @param str
 * @param {IOptions} options
 * @returns {string}
 */
function zh2jp(str, options) {
    if (!REGEXP_TEST.test(str.toString())) {
        return str;
    }
    options = Object.assign({}, exports.defaultOptions, options);
    return util_1.split(str)
        .map(function (char) {
        if (options.skip && options.skip.indexOf(char) != -1) {
            return char;
        }
        let c;
        if (c = _getdata(char, exports.KEY_ZHT, exports.KEY_JP, options.safe)) {
            return c;
        }
        else if (c = _getdata(char, exports.KEY_ZHS, exports.KEY_JP, options.safe)) {
            return c;
        }
        return char;
    })
        .join('');
}
exports.zh2jp = zh2jp;
/**
 * only 只將簡繁日 當中共通的 簡繁漢字 => 轉為日文漢字
 *
 * @alias zh2jp
 *
 * @param str
 * @param {IOptions} options
 * @returns {string}
 */
exports.cjk2jp = zh2jp;
/**
 * only 只將簡繁日 當中共通的 漢字 => 轉為繁體漢字
 * 請勿作為簡繁轉換用
 *
 * @param str
 * @param {IOptions} options
 * @returns {string}
 */
function cjk2zht(str, options) {
    if (!REGEXP_TEST.test(str.toString())) {
        return str;
    }
    options = Object.assign({}, exports.defaultOptions, options);
    return util_1.split(str)
        .map(function (char) {
        if (options.skip && options.skip.indexOf(char) != -1) {
            return char;
        }
        let c;
        if (c = _getdata(char, exports.KEY_JP, exports.KEY_ZHT, options.safe)) {
            return c;
        }
        else if (c = _getdata(char, exports.KEY_ZHS, exports.KEY_ZHT, options.safe)) {
            return c;
        }
        return char;
    })
        .join('');
}
exports.cjk2zht = cjk2zht;
/**
 * only 只將簡繁日 當中共通的 漢字 => 轉為簡體漢字
 * 請勿作為簡繁轉換用
 *
 * @param str
 * @param {IOptions} options
 * @returns {string}
 */
function cjk2zhs(str, options) {
    if (!REGEXP_TEST.test(str.toString())) {
        return str;
    }
    options = Object.assign({}, exports.defaultOptions, options);
    return util_1.split(str)
        .map(function (char) {
        if (options.skip && options.skip.indexOf(char) != -1) {
            return char;
        }
        let c;
        if (c = _getdata(char, exports.KEY_JP, exports.KEY_ZHS, options.safe)) {
            return c;
        }
        else if (c = _getdata(char, exports.KEY_ZHT, exports.KEY_ZHS, options.safe)) {
            return c;
        }
        return char;
    })
        .join('');
}
exports.cjk2zhs = cjk2zhs;
//import * as fs from 'fs-extra';
//fs.outputJSON('./teachKanjiComparison.cache.json', TABLE, {
//	spaces: "\t",
//});
//fs.outputJSON('./teachKanjiComparison.cache2.json', TABLE_SAFE, {
//	spaces: "\t",
//});
//
//console.log(zhs2jp(1));
//
//let t = '魔物解説　ランク等話　蚀蝕蝕王で触王 冒険者ギルド解説 蚀|蝕战|戦马|馬亚|亞國預中日漢字對照表'
//
//console.log(zh2jp(t));
//console.log(zht2jp(t));
//console.log(zhs2jp(t));
//
//console.log(zht2zhs(t));
//console.log(zhs2zht(t));
function init(overwrite) {
    if (inited && !overwrite) {
        return exports.TABLE;
    }
    exports.TABLE = _(table_1.default);
    exports.TABLE_SAFE = _(table_1.TABLE_SAFE);
    function _(src) {
        let to = {};
        to[exports.KEY_JP] = {};
        to[exports.KEY_ZHT] = {};
        to[exports.KEY_ZHS] = {};
        src.forEach(function (vrow) {
            let [jp, zht, zhs] = vrow;
            let k = exports.KEY_JP;
            for (let c of jp) {
                if (!c || to[k][c]) {
                    continue;
                }
                to[k][c] = to[k][c] || {};
                to[k][c][k] = c;
                to[k][c][exports.KEY_ZHT] = zht[0];
                to[k][c][exports.KEY_ZHS] = zhs[0];
            }
            k = exports.KEY_ZHT;
            for (let c of zht) {
                if (!c || to[k][c]) {
                    continue;
                }
                to[k][c] = to[k][c] || {};
                to[k][c][exports.KEY_JP] = jp[0];
                to[k][c][k] = c;
                to[k][c][exports.KEY_ZHS] = zhs[0];
            }
            k = exports.KEY_ZHS;
            for (let c of zhs) {
                if (!c || to[k][c]) {
                    continue;
                }
                to[k][c] = to[k][c] || {};
                to[k][c][exports.KEY_JP] = jp[0];
                to[k][c][exports.KEY_ZHT] = zht[0];
                to[k][c][k] = c;
            }
        });
        // @ts-ignore
        return to;
    }
    inited = true;
    return exports.TABLE;
}
exports.init = init;
function _getdata(char, from, to, safe) {
    if (safe) {
        return (exports.TABLE_SAFE[from][char]) ? exports.TABLE_SAFE[from][char][to] : null;
    }
    return (exports.TABLE[from][char]) ? exports.TABLE[from][char][to] : null;
}
exports._getdata = _getdata;
exports.default = exports;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29yZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNvcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7O0dBT0c7O0FBRUgsa0NBQWdDO0FBQ2hDLG1DQUFvRTtBQUczRCxxQkFIRixlQUFVLENBR0U7QUFBRSwwQkFIYyxrQkFBZSxDQUdkO0FBRnBDLHlEQUEwRDtBQUk3QyxRQUFBLE1BQU0sR0FBRyxJQUFJLENBQUM7QUFDZCxRQUFBLE9BQU8sR0FBRyxLQUFLLENBQUM7QUFDaEIsUUFBQSxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBSTdCLElBQUksTUFBTSxHQUFHLEtBQUssQ0FBQztBQXFDTixRQUFBLGNBQWMsR0FBYTtJQUN2QyxJQUFJLEVBQUUsSUFBSTtDQUNWLENBQUM7QUFFRix5Q0FBeUM7QUFDekMsTUFBTSxXQUFXLEdBQUcsSUFBSSxNQUFNLENBQUMsdUJBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0FBRXBFLElBQVUsQ0FBQyxDQWlEVjtBQWpERCxXQUFVLENBQUM7SUFFVixJQUFJLEVBQUUsQ0FBQztJQVNQLElBQUksS0FBSyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBSyxDQUFDLENBQUM7SUFFL0IsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLElBQWtCO1FBRXpDLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFnQjtZQUV2QyxJQUFJLElBQUksSUFBSSxFQUFFO2dCQUFFLE9BQU87WUFFdkIsQ0FBQyxDQUFDLEdBQUcsSUFBSSxJQUFJLEVBQUUsRUFBRSxDQUFDLEdBQUcsVUFBVSxHQUFHLEVBQUUsT0FBa0I7Z0JBRXJELElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxFQUNyQztvQkFDQyxPQUFPLEdBQUcsQ0FBQztpQkFDWDtnQkFFRCxPQUFPLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FB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QUFPLENBQUMsa0JBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxrQkFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7S0FDcEU7SUFFRCxPQUFPLENBQUMsYUFBSyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLGFBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQzNELENBQUM7QUFSRCw0QkFRQztBQU9ELGtCQUFlLE9BQWtDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgdXNlciBvbiAyMDE3LzEyLzI0LzAyNC5cbiAqXG4gKiB0aGlzIG1vZHVsZSBvbmx5IGRvIHRoZSBjaGFyIGlzIGV4aXN0cyBpbiBqcCwgemh0LCB6aHNcbiAqIHNvIGRvbid0IHVzZSB0aGlzIG1vZHVsZSB3aGVuIHUgd2FubmEgZnVsbHkgemh0IDw9PiB6aHNcbiAqXG4gKiDnm67liY3lj6rmlK/mj7Qg57Ch57mB5pel5ryi5a2XIOS4pumdnuWFqCBjamsg5ryi5a2X5pSv5o+0XG4gKi9cblxuaW1wb3J0IHsgc3BsaXQgfSBmcm9tICcuLi91dGlsJztcbmltcG9ydCBaSEpQX1RBQkxFLCB7IFRBQkxFX1NBRkUgYXMgWkhKUF9UQUJMRV9TQUZFIH0gZnJvbSAnLi90YWJsZSc7XG5pbXBvcnQgeyBfcmVfY2prX2NvbnYgfSBmcm9tICdyZWdleHAtaGVscGVyL2xpYi9jamstY29udic7XG5cbmV4cG9ydCB7IFpISlBfVEFCTEUsIFpISlBfVEFCTEVfU0FGRSB9O1xuXG5leHBvcnQgY29uc3QgS0VZX0pQID0gJ2pwJztcbmV4cG9ydCBjb25zdCBLRVlfWkhUID0gJ3podCc7XG5leHBvcnQgY29uc3QgS0VZX1pIUyA9ICd6aHMnO1xuXG5leHBvcnQgdHlwZSBJS0VZX0ZST01fVE8gPSB0eXBlb2YgS0VZX0pQIHwgdHlwZW9mIEtFWV9aSFQgfCB0eXBlb2YgS0VZX1pIUyB8ICdqcCcgfCAnemh0JyB8ICd6aHMnO1xuXG5sZXQgaW5pdGVkID0gZmFsc2U7XG5cbmV4cG9ydCBsZXQgVEFCTEU6IElUQUJMRV9NQUlOO1xuXG5leHBvcnQgbGV0IFRBQkxFX1NBRkU6IElUQUJMRV9NQUlOO1xuXG5leHBvcnQgaW50ZXJmYWNlIElUQUJMRV9NQUlOXG57XG5cdFtLRVlfSlBdOiBJVEFCTEUsXG5cdFtLRVlfWkhUXTogSVRBQkxFLFxuXHRbS0VZX1pIU106IElUQUJMRSxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJVEFCTEVcbntcblx0W2tleTogc3RyaW5nXTogSVRBQkxFU1VCXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRBQkxFU1VCXG57XG5cdFtLRVlfSlBdOiBzdHJpbmcsXG5cdFtLRVlfWkhUXTogc3RyaW5nLFxuXHRbS0VZX1pIU106IHN0cmluZyxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJT3B0aW9uc1xue1xuXHQvKipcblx0ICog5b+955Wl55qE5a2XIG9yIOS7u+S9leaUr+aPtCBpbmRleE9mIOeahCBPYmplY3Rcblx0ICovXG5cdHNraXA/LFxuXHQvKipcblx0ICogc2FmZSBtb2RlXG5cdCAqL1xuXHRzYWZlPzogYm9vbGVhbixcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRPcHRpb25zOiBJT3B0aW9ucyA9IHtcblx0c2FmZTogdHJ1ZSxcbn07XG5cbi8vIC9bXFx1NEUwMC1cXHU5RkZGXFx1ezIwMDAwfS1cXHV7MkZBMUZ9XSsvdVxuY29uc3QgUkVHRVhQX1RFU1QgPSBuZXcgUmVnRXhwKF9yZV9jamtfY29udigndScpLnNvdXJjZSArICcrJywgJ3UnKTtcblxubmFtZXNwYWNlIF9cbntcblx0aW5pdCgpO1xuXG5cdGV4cG9ydCBsZXQganAyemh0OiBJRnJvbTJUbztcblx0ZXhwb3J0IGxldCBqcDJ6aHM6IElGcm9tMlRvO1xuXHRleHBvcnQgbGV0IHpodDJqcDogSUZyb20yVG87XG5cdGV4cG9ydCBsZXQgemh0MnpoczogSUZyb20yVG87XG5cdGV4cG9ydCBsZXQgemhzMmpwOiBJRnJvbTJUbztcblx0ZXhwb3J0IGxldCB6aHMyemh0OiBJRnJvbTJUbztcblxuXHRsZXQgbGFuZ3MgPSBPYmplY3Qua2V5cyhUQUJMRSk7XG5cblx0bGFuZ3MuZm9yRWFjaChmdW5jdGlvbiAoZnJvbTogSUtFWV9GUk9NX1RPKVxuXHR7XG5cdFx0bGFuZ3MuZm9yRWFjaChmdW5jdGlvbiAodG86IElLRVlfRlJPTV9UTylcblx0XHR7XG5cdFx0XHRpZiAoZnJvbSA9PSB0bykgcmV0dXJuO1xuXG5cdFx0XHRfW2Ake2Zyb219MiR7dG99YF0gPSBmdW5jdGlvbiAoc3RyLCBvcHRpb25zPzogSU9wdGlvbnMpOiBzdHJpbmdcblx0XHRcdHtcblx0XHRcdFx0aWYgKCFSRUdFWFBfVEVTVC50ZXN0KHN0ci50b1N0cmluZygpKSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHJldHVybiBzdHI7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuXG5cdFx0XHRcdHJldHVybiBzcGxpdChzdHIpXG5cdFx0XHRcdFx0Lm1hcChmdW5jdGlvbiAoY2hhcjogc3RyaW5nKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGlmIChvcHRpb25zLnNraXAgJiYgb3B0aW9ucy5za2lwLmluZGV4T2YoY2hhcikgIT0gLTEpXG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBjaGFyO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRsZXQgYzogc3RyaW5nO1xuXHRcdFx0XHRcdFx0aWYgKGMgPSBfZ2V0ZGF0YShjaGFyLCBmcm9tLCB0bywgb3B0aW9ucy5zYWZlKSlcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdHJldHVybiBjaGFyO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0LmpvaW4oJycpXG5cdFx0XHRcdFx0O1xuXHRcdFx0fSBhcyBJRnJvbTJUbztcblx0XHR9KTtcblx0fSk7XG59XG5cbi8qKlxuICogb25seSDlj6rlsIcg5pel5paH5ryi5a2XID0+IOi9ieeCuue5gea8ouWtl1xuICogQHR5cGUge0lGcm9tMlRvfVxuICovXG5leHBvcnQgY29uc3QganAyemh0ID0gXy5qcDJ6aHQgYXMgSUZyb20yVG87XG4vKipcbiAqIG9ubHkg5Y+q5bCHIOaXpeaWh+a8ouWtlyA9PiDovYnngrrnsKHmvKLlrZdcbiAqIEB0eXBlIHtJRnJvbTJUb31cbiAqL1xuZXhwb3J0IGNvbnN0IGpwMnpocyA9IF8uanAyemhzIGFzIElGcm9tMlRvO1xuXG4vKipcbiAqIG9ubHkg57Ch5ryi5a2XID0+IOi9ieeCuuaXpea8ouWtl1xuICogQHR5cGUge0lGcm9tMlRvfVxuICovXG5leHBvcnQgY29uc3QgemhzMmpwID0gXy56aHMyanA7XG5cbi8qKlxuICogb25seSDlj6rlsIcg57mB5ryi5a2XID0+IOi9ieeCuuaXpeaWh+a8ouWtl1xuICogQHR5cGUge0lGcm9tMlRvfVxuICovXG5leHBvcnQgY29uc3Qgemh0MmpwID0gXy56aHQyanA7XG5cbi8qKlxuICogb25seSDlj6rlsIfnsKHnuYHml6Ug55W25Lit5YWx6YCa55qEIOe5gea8ouWtlyA9PiDovYnngrrnsKHmvKLlrZdcbiAqIOiri+WLv+S9nOeCuuewoee5gei9ieaPm+eUqFxuICogQHR5cGUge0lGcm9tMlRvfVxuICovXG5leHBvcnQgY29uc3Qgemh0MnpocyA9IF8uemh0MnpocztcblxuLyoqXG4gKiBvbmx5IOWPquWwh+ewoee5geaXpSDnlbbkuK3lhbHpgJrnmoQg57Ch5ryi5a2XID0+IOi9ieeCuue5gea8ouWtl1xuICog6KuL5Yu/5L2c54K657Ch57mB6L2J5o+b55SoXG4gKiBAdHlwZSB7SUZyb20yVG99XG4gKi9cbmV4cG9ydCBjb25zdCB6aHMyemh0ID0gXy56aHMyemh0O1xuXG4vKipcbiAqIG9ubHkg5Y+q5bCH57Ch57mB5pelIOeVtuS4reWFsemAmueahCDnsKHnuYHmvKLlrZcgPT4g6L2J54K65pel5paH5ryi5a2XXG4gKlxuICogQGFsaWFzIGNqazJqcFxuICpcbiAqIEBwYXJhbSBzdHJcbiAqIEBwYXJhbSB7SU9wdGlvbnN9IG9wdGlvbnNcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB6aDJqcChzdHIsIG9wdGlvbnM/OiBJT3B0aW9ucyk6IHN0cmluZ1xue1xuXHRpZiAoIVJFR0VYUF9URVNULnRlc3Qoc3RyLnRvU3RyaW5nKCkpKVxuXHR7XG5cdFx0cmV0dXJuIHN0cjtcblx0fVxuXG5cdG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cblx0cmV0dXJuIHNwbGl0KHN0cilcblx0XHQubWFwKGZ1bmN0aW9uIChjaGFyOiBzdHJpbmcpXG5cdFx0e1xuXHRcdFx0aWYgKG9wdGlvbnMuc2tpcCAmJiBvcHRpb25zLnNraXAuaW5kZXhPZihjaGFyKSAhPSAtMSlcblx0XHRcdHtcblx0XHRcdFx0cmV0dXJuIGNoYXI7XG5cdFx0XHR9XG5cblx0XHRcdGxldCBjOiBzdHJpbmc7XG5cdFx0XHRpZiAoYyA9IF9nZXRkYXRhKGNoYXIsIEtFWV9aSFQsIEtFWV9KUCwgb3B0aW9ucy5zYWZlKSlcblx0XHRcdHtcblx0XHRcdFx0cmV0dXJuIGM7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmIChjID0gX2dldGRhdGEoY2hhciwgS0VZX1pIUywgS0VZX0pQLCBvcHRpb25zLnNhZmUpKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm4gYztcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGNoYXI7XG5cdFx0fSlcblx0XHQuam9pbignJylcblx0XHQ7XG59XG5cbi8qKlxuICogb25seSDlj6rlsIfnsKHnuYHml6Ug55W25Lit5YWx6YCa55qEIOewoee5gea8ouWtlyA9PiDovYnngrrml6XmlofmvKLlrZdcbiAqXG4gKiBAYWxpYXMgemgyanBcbiAqXG4gKiBAcGFyYW0gc3RyXG4gKiBAcGFyYW0ge0lPcHRpb25zfSBvcHRpb25zXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5leHBvcnQgY29uc3QgY2prMmpwID0gemgyanA7XG5cbi8qKlxuICogb25seSDlj6rlsIfnsKHnuYHml6Ug55W25Lit5YWx6YCa55qEIOa8ouWtlyA9PiDovYnngrrnuYHpq5TmvKLlrZdcbiAqIOiri+WLv+S9nOeCuuewoee5gei9ieaPm+eUqFxuICpcbiAqIEBwYXJhbSBzdHJcbiAqIEBwYXJhbSB7SU9wdGlvbnN9IG9wdGlvbnNcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjamsyemh0KHN0ciwgb3B0aW9ucz86IElPcHRpb25zKTogc3RyaW5nXG57XG5cdGlmICghUkVHRVhQX1RFU1QudGVzdChzdHIudG9TdHJpbmcoKSkpXG5cdHtcblx0XHRyZXR1cm4gc3RyO1xuXHR9XG5cblx0b3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuXHRyZXR1cm4gc3BsaXQoc3RyKVxuXHRcdC5tYXAoZnVuY3Rpb24gKGNoYXI6IHN0cmluZylcblx0XHR7XG5cdFx0XHRpZiAob3B0aW9ucy5za2lwICYmIG9wdGlvbnMuc2tpcC5pbmRleE9mKGNoYXIpICE9IC0xKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm4gY2hhcjtcblx0XHRcdH1cblxuXHRcdFx0bGV0IGM6IHN0cmluZztcblx0XHRcdGlmIChjID0gX2dldGRhdGEoY2hhciwgS0VZX0pQLCBLRVlfWkhULCBvcHRpb25zLnNhZmUpKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm4gYztcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYgKGMgPSBfZ2V0ZGF0YShjaGFyLCBLRVlfWkhTLCBLRVlfWkhULCBvcHRpb25zLnNhZmUpKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm4gYztcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGNoYXI7XG5cdFx0fSlcblx0XHQuam9pbignJylcblx0XHQ7XG59XG5cbi8qKlxuICogb25seSDlj6rlsIfnsKHnuYHml6Ug55W25Lit5YWx6YCa55qEIOa8ouWtlyA9PiDovYnngrrnsKHpq5TmvKLlrZdcbiAqIOiri+WLv+S9nOeCuuewoee5gei9ieaPm+eUqFxuICpcbiAqIEBwYXJhbSBzdHJcbiAqIEBwYXJhbSB7SU9wdGlvbnN9IG9wdGlvbnNcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjamsyemhzKHN0ciwgb3B0aW9ucz86IElPcHRpb25zKTogc3RyaW5nXG57XG5cdGlmICghUkVHRVhQX1RFU1QudGVzdChzdHIudG9TdHJpbmcoKSkpXG5cdHtcblx0XHRyZXR1cm4gc3RyO1xuXHR9XG5cblx0b3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuXHRyZXR1cm4gc3BsaXQoc3RyKVxuXHRcdC5tYXAoZnVuY3Rpb24gKGNoYXI6IHN0cmluZylcblx0XHR7XG5cdFx0XHRpZiAob3B0aW9ucy5za2lwICYmIG9wdGlvbnMuc2tpcC5pbmRleE9mKGNoYXIpICE9IC0xKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm4gY2hhcjtcblx0XHRcdH1cblxuXHRcdFx0bGV0IGM6IHN0cmluZztcblx0XHRcdGlmIChjID0gX2dldGRhdGEoY2hhciwgS0VZX0pQLCBLRVlfWkhTLCBvcHRpb25zLnNhZmUpKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm4gYztcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYgKGMgPSBfZ2V0ZGF0YShjaGFyLCBLRVlfWkhULCBLRVlfWkhTLCBvcHRpb25zLnNhZmUpKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXR1cm4gYztcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGNoYXI7XG5cdFx0fSlcblx0XHQuam9pbignJylcblx0XHQ7XG59XG5cbi8vaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMtZXh0cmEnO1xuLy9mcy5vdXRwdXRKU09OKCcuL3RlYWNoS2FuamlDb21wYXJpc29uLmNhY2hlLmpzb24nLCBUQUJMRSwge1xuLy9cdHNwYWNlczogXCJcXHRcIixcbi8vfSk7XG4vL2ZzLm91dHB1dEpTT04oJy4vdGVhY2hLYW5qaUNvbXBhcmlzb24uY2FjaGUyLmpzb24nLCBUQUJMRV9TQUZFLCB7XG4vL1x0c3BhY2VzOiBcIlxcdFwiLFxuLy99KTtcbi8vXG4vL2NvbnNvbGUubG9nKHpoczJqcCgxKSk7XG4vL1xuLy9sZXQgdCA9ICfprZTnianop6PoqqzjgIDjg6njg7Pjgq/nrYnoqbHjgIDomoDonZXonZXnjovjgafop6bnjosg5YaS6Zm66ICF44Ku44Or44OJ6Kej6KqsIOiagHzonZXmiJh85oim6amsfOmmrOS6mnzkup7lnIvpoJDkuK3ml6XmvKLlrZflsI3nhafooagnXG4vL1xuLy9jb25zb2xlLmxvZyh6aDJqcCh0KSk7XG4vL2NvbnNvbGUubG9nKHpodDJqcCh0KSk7XG4vL2NvbnNvbGUubG9nKHpoczJqcCh0KSk7XG4vL1xuLy9jb25zb2xlLmxvZyh6aHQyemhzKHQpKTtcbi8vY29uc29sZS5sb2coemhzMnpodCh0KSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0KG92ZXJ3cml0ZT86IGJvb2xlYW4pXG57XG5cdGlmIChpbml0ZWQgJiYgIW92ZXJ3cml0ZSlcblx0e1xuXHRcdHJldHVybiBUQUJMRTtcblx0fVxuXG5cdFRBQkxFID0gXyhaSEpQX1RBQkxFKTtcblx0VEFCTEVfU0FGRSA9IF8oWkhKUF9UQUJMRV9TQUZFKTtcblxuXHRmdW5jdGlvbiBfKHNyYyk6IElUQUJMRV9NQUlOXG5cdHtcblx0XHRsZXQgdG8gPSB7fTtcblx0XHR0b1tLRVlfSlBdID0ge30gYXMgSVRBQkxFO1xuXHRcdHRvW0tFWV9aSFRdID0ge30gYXMgSVRBQkxFO1xuXHRcdHRvW0tFWV9aSFNdID0ge30gYXMgSVRBQkxFO1xuXG5cdFx0c3JjLmZvckVhY2goZnVuY3Rpb24gKHZyb3c6IHN0cmluZ1tdKVxuXHRcdHtcblx0XHRcdGxldCBbanAsIHpodCwgemhzXSA9IHZyb3c7XG5cblx0XHRcdGxldCBrID0gS0VZX0pQO1xuXHRcdFx0Zm9yIChsZXQgYyBvZiBqcClcblx0XHRcdHtcblx0XHRcdFx0aWYgKCFjIHx8IHRvW2tdW2NdKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0b1trXVtjXSA9IHRvW2tdW2NdIHx8IHt9IGFzIElUQUJMRVNVQjtcblxuXHRcdFx0XHR0b1trXVtjXVtrXSA9IGM7XG5cdFx0XHRcdHRvW2tdW2NdW0tFWV9aSFRdID0gemh0WzBdO1xuXHRcdFx0XHR0b1trXVtjXVtLRVlfWkhTXSA9IHpoc1swXTtcblx0XHRcdH1cblxuXHRcdFx0ayA9IEtFWV9aSFQ7XG5cdFx0XHRmb3IgKGxldCBjIG9mIHpodClcblx0XHRcdHtcblx0XHRcdFx0aWYgKCFjIHx8IHRvW2tdW2NdKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0b1trXVtjXSA9IHRvW2tdW2NdIHx8IHt9IGFzIElUQUJMRVNVQjtcblxuXHRcdFx0XHR0b1trXVtjXVtLRVlfSlBdID0ganBbMF07XG5cdFx0XHRcdHRvW2tdW2NdW2tdID0gYztcblx0XHRcdFx0dG9ba11bY11bS0VZX1pIU10gPSB6aHNbMF07XG5cdFx0XHR9XG5cblx0XHRcdGsgPSBLRVlfWkhTO1xuXHRcdFx0Zm9yIChsZXQgYyBvZiB6aHMpXG5cdFx0XHR7XG5cdFx0XHRcdGlmICghYyB8fCB0b1trXVtjXSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dG9ba11bY10gPSB0b1trXVtjXSB8fCB7fSBhcyBJVEFCTEVTVUI7XG5cblx0XHRcdFx0dG9ba11bY11bS0VZX0pQXSA9IGpwWzBdO1xuXHRcdFx0XHR0b1trXVtjXVtLRVlfWkhUXSA9IHpodFswXTtcblx0XHRcdFx0dG9ba11bY11ba10gPSBjO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdHJldHVybiB0bztcblx0fVxuXG5cdGluaXRlZCA9IHRydWU7XG5cblx0cmV0dXJuIFRBQkxFO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2dldGRhdGEoY2hhcjogc3RyaW5nLCBmcm9tOiBJS0VZX0ZST01fVE8sIHRvOiBJS0VZX0ZST01fVE8sIHNhZmU/OiBib29sZWFuKTogc3RyaW5nXG57XG5cdGlmIChzYWZlKVxuXHR7XG5cdFx0cmV0dXJuIChUQUJMRV9TQUZFW2Zyb21dW2NoYXJdKSA/IFRBQkxFX1NBRkVbZnJvbV1bY2hhcl1bdG9dIDogbnVsbDtcblx0fVxuXG5cdHJldHVybiAoVEFCTEVbZnJvbV1bY2hhcl0pID8gVEFCTEVbZnJvbV1bY2hhcl1bdG9dIDogbnVsbDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJRnJvbTJUbyBleHRlbmRzIEZ1bmN0aW9uXG57XG5cdChzdHIsIG9wdGlvbnM/OiBJT3B0aW9ucyk6IHN0cmluZztcbn1cblxuZXhwb3J0IGRlZmF1bHQgZXhwb3J0cyBhcyB0eXBlb2YgaW1wb3J0KCcuL2NvcmUnKTtcbiJdfQ==