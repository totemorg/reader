"use strict";
/**
 * Created by user on 2018/4/19/019.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const POSTAG_1 = require("../POSTAG");
const sort_object_keys2_1 = require("sort-object-keys2");
//export const SYMBOL_DEBUG_KEY = Symbol.for('_debug');
exports.SYMBOL_DEBUG_KEY = '_debug';
function clearTokemDebug(data, returnClone) {
    if (returnClone) {
        return {
            w: data.w,
            p: data.p,
            f: data.f,
        };
    }
    for (let k in data) {
        if (k != 'w' && k != 'p' && k != 'f') {
            delete data[k];
        }
    }
    delete data[exports.SYMBOL_DEBUG_KEY];
    return data;
}
exports.clearTokemDebug = clearTokemDebug;
function debugToken(data, attr, returnToken, ...argv) {
    if (attr) {
        data[exports.SYMBOL_DEBUG_KEY] = Object.assign(data[exports.SYMBOL_DEBUG_KEY] || {}, attr);
    }
    if (returnToken) {
        return data;
    }
    return (data[exports.SYMBOL_DEBUG_KEY] || {});
}
exports.debugToken = debugToken;
function debug_token(ks, returnSource) {
    let ks2 = [];
    // @ts-ignore
    ks.map(function (v, index) {
        //v.index = index;
        // @ts-ignore
        debugToken(v, {
            index,
        });
        if (v.p) {
            // @ts-ignore
            token_add_info(v);
        }
        else if (v.m) {
            // @ts-ignore
            v.m.map(token_add_info);
        }
        else {
            // @ts-ignore
            ks2.push(v);
        }
    });
    return returnSource ? ks : ks2;
}
exports.debug_token = debug_token;
function token_add_info(v) {
    if (v.p) {
        v.ps = POSTAG_1.POSTAG.zhName(v.p);
        //v.ps_en = POSTAG.enName(v.p);
        let debug = debugToken(v, {
            ps_en: POSTAG_1.POSTAG.enName(v.p),
        });
        v.pp = toHex(v.p);
        if (v.op) {
            v.ops = POSTAG_1.POSTAG.zhName(v.op);
            v.opp = toHex(v.op);
        }
        if (v.m) {
            v.m.map(function (v) {
                if (typeof v == 'string') {
                    return v;
                }
                return token_add_info(v);
            });
        }
        if (debug._source) {
            token_add_info(debug._source);
        }
    }
    if (v) {
        sort_object_keys2_1.default(v, {
            keys: [
                'w',
                'p',
                'f',
                'ps',
                'pp',
                'ow',
                'op',
                'ops',
                'opp',
                'os',
            ],
            useSource: true,
        });
    }
    return v;
}
exports.token_add_info = token_add_info;
function toHex(p) {
    return '0x' + p
        .toString(16)
        .padStart(4, '0')
        .toUpperCase();
}
exports.toHex = toHex;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVidWcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJkZWJ1Zy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBRUgsc0NBQW1DO0FBRW5DLHlEQUErQztBQUUvQyx1REFBdUQ7QUFDMUMsUUFBQSxnQkFBZ0IsR0FBRyxRQUFRLENBQUM7QUFvQ3pDLFNBQWdCLGVBQWUsQ0FBQyxJQUFvQixFQUFFLFdBQXFCO0lBRTFFLElBQUksV0FBVyxFQUNmO1FBQ0MsT0FBTztZQUNOLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUNULENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUNULENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztTQUNULENBQUM7S0FDRjtJQUVELEtBQUssSUFBSSxDQUFDLElBQUksSUFBSSxFQUNsQjtRQUNDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLEVBQ3BDO1lBQ0MsT0FBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDZjtLQUNEO0lBRUQsT0FBTyxJQUFJLENBQUMsd0JBQWdCLENBQUMsQ0FBQztJQUU5QixPQUFPLElBQWEsQ0FBQztBQUN0QixDQUFDO0FBdEJELDBDQXNCQztBQVVELFNBQWdCLFVBQVUsQ0FBaUQsSUFBTyxFQUNqRixJQUF5QixFQUN6QixXQUFxQixFQUFFLEdBQUcsSUFBSTtJQUc5QixJQUFJLElBQUksRUFDUjtRQUNDLElBQUksQ0FBQyx3QkFBZ0IsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLHdCQUFnQixDQUFDLElBQUksRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzNFO0lBRUQsSUFBSSxXQUFXLEVBQ2Y7UUFDQyxPQUFPLElBQUksQ0FBQztLQUNaO0lBRUQsT0FBTyxDQUFDLElBQUksQ0FBQyx3QkFBZ0IsQ0FBQyxJQUFJLEVBQUUsQ0FBbUIsQ0FBQztBQUN6RCxDQUFDO0FBaEJELGdDQWdCQztBQUVELFNBQWdCLFdBQVcsQ0FBdUIsRUFBWSxFQUFFLFlBQXNCO0lBRXJGLElBQUksR0FBRyxHQUEwQixFQUFFLENBQUM7SUFFcEMsYUFBYTtJQUNiLEVBQUUsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLEVBQUUsS0FBSztRQUV4QixrQkFBa0I7UUFFbEIsYUFBYTtRQUNiLFVBQVUsQ0FBQyxDQUFDLEVBQUU7WUFDYixLQUFLO1NBQ0wsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUNQO1lBQ0MsYUFBYTtZQUNiLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNsQjthQUNJLElBQUksQ0FBQyxDQUFDLENBQUMsRUFDWjtZQUNDLGFBQWE7WUFDYixDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQztTQUN4QjthQUVEO1lBQ0MsYUFBYTtZQUNiLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDWjtJQUNGLENBQUMsQ0FBQyxDQUFDO0lBRUgsT0FBTyxZQUFZLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDO0FBQ2hDLENBQUM7QUFoQ0Qsa0NBZ0NDO0FBRUQsU0FBZ0IsY0FBYyxDQUF1QixDQUFJO0lBRXhELElBQUksQ0FBQyxDQUFDLENBQUMsRUFDUDtRQUNDLENBQUMsQ0FBQyxFQUFFLEdBQUcsZUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUIsK0JBQStCO1FBRS9CLElBQUksS0FBSyxHQUFHLFVBQVUsQ0FBQyxDQUFDLEVBQUU7WUFDekIsS0FBSyxFQUFFLGVBQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN6QixDQUFDLENBQUM7UUFFSCxDQUFDLENBQUMsRUFBRSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFbEIsSUFBSSxDQUFDLENBQUMsRUFBRSxFQUNSO1lBQ0MsQ0FBQyxDQUFDLEdBQUcsR0FBRyxlQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUM1QixDQUFDLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDcEI7UUFFRCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1A7WUFDQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUM7Z0JBRWxCLElBQUksT0FBTyxDQUFDLElBQUksUUFBUSxFQUN4QjtvQkFDQyxPQUFPLENBQUMsQ0FBQztpQkFDVDtnQkFFRCxPQUFPLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxQixDQUFDLENBQUMsQ0FBQztTQUNIO1FBRUQsSUFBSSxLQUFLLENBQUMsT0FBTyxFQUNqQjtZQUNDLGNBQWMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDOUI7S0FDRDtJQUVELElBQUksQ0FBQyxFQUNMO1FBQ0MsMkJBQWMsQ0FBQyxDQUFDLEVBQUU7WUFDakIsSUFBSSxFQUFFO2dCQUNMLEdBQUc7Z0JBQ0gsR0FBRztnQkFDSCxHQUFHO2dCQUVILElBQUk7Z0JBQ0osSUFBSTtnQkFFSixJQUFJO2dCQUNKLElBQUk7Z0JBQ0osS0FBSztnQkFDTCxLQUFLO2dCQUVMLElBQUk7YUFDSjtZQUVELFNBQVMsRUFBRSxJQUFJO1NBQ2YsQ0FBQyxDQUFDO0tBQ0g7SUFFRCxPQUFPLENBQUMsQ0FBQztBQUNWLENBQUM7QUE5REQsd0NBOERDO0FBRUQsU0FBZ0IsS0FBSyxDQUFDLENBQVM7SUFFOUIsT0FBTyxJQUFJLEdBQUcsQ0FBQztTQUNiLFFBQVEsQ0FBQyxFQUFFLENBQUM7U0FDWixRQUFRLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQztTQUNoQixXQUFXLEVBQUUsQ0FDYjtBQUNILENBQUM7QUFQRCxzQkFPQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSB1c2VyIG9uIDIwMTgvNC8xOS8wMTkuXG4gKi9cblxuaW1wb3J0IHsgUE9TVEFHIH0gZnJvbSAnLi4vUE9TVEFHJztcbmltcG9ydCB7IElXb3JkIH0gZnJvbSAnLi4vc2VnbWVudC90eXBlcyc7XG5pbXBvcnQgc29ydE9iamVjdEtleXMgZnJvbSAnc29ydC1vYmplY3Qta2V5czInO1xuXG4vL2V4cG9ydCBjb25zdCBTWU1CT0xfREVCVUdfS0VZID0gU3ltYm9sLmZvcignX2RlYnVnJyk7XG5leHBvcnQgY29uc3QgU1lNQk9MX0RFQlVHX0tFWSA9ICdfZGVidWcnO1xuXG5leHBvcnQgdHlwZSBJV29yZERlYnVnSW5mbzxUIGV4dGVuZHMgSVdvcmREZWJ1ZyA9IElXb3JkRGVidWc+ID0ge1xuXHRaaHRTeW5vbnltT3B0aW1pemVyPzogYm9vbGVhbixcblx0Y29udmVydFN5bm9ueW0/OiBib29sZWFuLFxuXHRhdXRvQ3JlYXRlPzogYm9vbGVhbixcblxuXHRfc291cmNlPzogVCAmIElXb3JkRGVidWcsXG5cblx0aW5kZXg/OiBudW1iZXIsXG5cdHBzX2VuPzogc3RyaW5nLFxuXG5cdFtrZXk6IHN0cmluZ106IGFueSxcblx0W2tleTogbnVtYmVyXTogYW55LFxufVxuXG5leHBvcnQgdHlwZSBJV29yZERlYnVnID0gSVdvcmQgJiB7XG5cblx0bT86IEFycmF5PElXb3JkRGVidWcgfCBzdHJpbmc+LFxuXG5cdHBzPzogc3RyaW5nLFxuXHRwcD86IHN0cmluZyxcblxuXHRvdz86IHN0cmluZyxcblx0b3A/OiBudW1iZXIsXG5cdG9wcz86IHN0cmluZyxcblx0b3BwPzogc3RyaW5nLFxuXG5cdG9zPzogYm9vbGVhbixcblxuXHRbU1lNQk9MX0RFQlVHX0tFWV0/OiBJV29yZERlYnVnSW5mbzxJV29yZERlYnVnPixcbn1cblxuLy8gQHRzLWlnbm9yZVxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVG9rZW1EZWJ1ZyhkYXRhOiBJV29yZERlYnVnSW5mbywgcmV0dXJuQ2xvbmU/OiBmYWxzZSk6IGRhdGEgaXMgSVdvcmRcbmV4cG9ydCBmdW5jdGlvbiBjbGVhclRva2VtRGVidWcoZGF0YTogSVdvcmREZWJ1Z0luZm8sIHJldHVybkNsb25lPzogdHJ1ZSk6IElXb3JkXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJUb2tlbURlYnVnKGRhdGE6IElXb3JkRGVidWdJbmZvLCByZXR1cm5DbG9uZT86IGJvb2xlYW4pOiBJV29yZFxue1xuXHRpZiAocmV0dXJuQ2xvbmUpXG5cdHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0dzogZGF0YS53LFxuXHRcdFx0cDogZGF0YS5wLFxuXHRcdFx0ZjogZGF0YS5mLFxuXHRcdH07XG5cdH1cblxuXHRmb3IgKGxldCBrIGluIGRhdGEpXG5cdHtcblx0XHRpZiAoayAhPSAndycgJiYgayAhPSAncCcgJiYgayAhPSAnZicpXG5cdFx0e1xuXHRcdFx0ZGVsZXRlIGRhdGFba107XG5cdFx0fVxuXHR9XG5cblx0ZGVsZXRlIGRhdGFbU1lNQk9MX0RFQlVHX0tFWV07XG5cblx0cmV0dXJuIGRhdGEgYXMgSVdvcmQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWJ1Z1Rva2VuPFQgZXh0ZW5kcyBJV29yZERlYnVnLCBVIGV4dGVuZHMgSVdvcmREZWJ1Z0luZm8+KGRhdGE6IFQsXG5cdGF0dHI6IFUgJiBJV29yZERlYnVnSW5mbyxcblx0cmV0dXJuVG9rZW46IHRydWUsIC4uLmFyZ3Zcbik6IFRcbmV4cG9ydCBmdW5jdGlvbiBkZWJ1Z1Rva2VuPFQgZXh0ZW5kcyBJV29yZERlYnVnLCBVIGV4dGVuZHMgSVdvcmREZWJ1Z0luZm8+KGRhdGE6IFQsXG5cdGF0dHI/OiBVICYgSVdvcmREZWJ1Z0luZm8sXG5cdHJldHVyblRva2VuPzogYm9vbGVhbiwgLi4uYXJndlxuKTogVSAmIElXb3JkRGVidWdJbmZvXG5leHBvcnQgZnVuY3Rpb24gZGVidWdUb2tlbjxUIGV4dGVuZHMgSVdvcmREZWJ1ZywgVSBleHRlbmRzIElXb3JkRGVidWdJbmZvPihkYXRhOiBULFxuXHRhdHRyPzogVSAmIElXb3JkRGVidWdJbmZvLFxuXHRyZXR1cm5Ub2tlbj86IGJvb2xlYW4sIC4uLmFyZ3Zcbilcbntcblx0aWYgKGF0dHIpXG5cdHtcblx0XHRkYXRhW1NZTUJPTF9ERUJVR19LRVldID0gT2JqZWN0LmFzc2lnbihkYXRhW1NZTUJPTF9ERUJVR19LRVldIHx8IHt9LCBhdHRyKTtcblx0fVxuXG5cdGlmIChyZXR1cm5Ub2tlbilcblx0e1xuXHRcdHJldHVybiBkYXRhO1xuXHR9XG5cblx0cmV0dXJuIChkYXRhW1NZTUJPTF9ERUJVR19LRVldIHx8IHt9KSBhcyBJV29yZERlYnVnSW5mbztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlYnVnX3Rva2VuPFQgZXh0ZW5kcyBJV29yZERlYnVnPihrczogQXJyYXk8VD4sIHJldHVyblNvdXJjZT86IGJvb2xlYW4pOiBBcnJheTxUIHwgSVdvcmREZWJ1Zz5cbntcblx0bGV0IGtzMjogQXJyYXk8VCB8IElXb3JkRGVidWc+ID0gW107XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRrcy5tYXAoZnVuY3Rpb24gKHYsIGluZGV4KVxuXHR7XG5cdFx0Ly92LmluZGV4ID0gaW5kZXg7XG5cblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0ZGVidWdUb2tlbih2LCB7XG5cdFx0XHRpbmRleCxcblx0XHR9KTtcblxuXHRcdGlmICh2LnApXG5cdFx0e1xuXHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0dG9rZW5fYWRkX2luZm8odik7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHYubSlcblx0XHR7XG5cdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHR2Lm0ubWFwKHRva2VuX2FkZF9pbmZvKTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdGtzMi5wdXNoKHYpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIHJldHVyblNvdXJjZSA/IGtzIDoga3MyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9rZW5fYWRkX2luZm88VCBleHRlbmRzIElXb3JkRGVidWc+KHY6IFQpXG57XG5cdGlmICh2LnApXG5cdHtcblx0XHR2LnBzID0gUE9TVEFHLnpoTmFtZSh2LnApO1xuXHRcdC8vdi5wc19lbiA9IFBPU1RBRy5lbk5hbWUodi5wKTtcblxuXHRcdGxldCBkZWJ1ZyA9IGRlYnVnVG9rZW4odiwge1xuXHRcdFx0cHNfZW46IFBPU1RBRy5lbk5hbWUodi5wKSxcblx0XHR9KTtcblxuXHRcdHYucHAgPSB0b0hleCh2LnApO1xuXG5cdFx0aWYgKHYub3ApXG5cdFx0e1xuXHRcdFx0di5vcHMgPSBQT1NUQUcuemhOYW1lKHYub3ApO1xuXHRcdFx0di5vcHAgPSB0b0hleCh2Lm9wKTtcblx0XHR9XG5cblx0XHRpZiAodi5tKVxuXHRcdHtcblx0XHRcdHYubS5tYXAoZnVuY3Rpb24gKHYpXG5cdFx0XHR7XG5cdFx0XHRcdGlmICh0eXBlb2YgdiA9PSAnc3RyaW5nJylcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHJldHVybiB2O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHRva2VuX2FkZF9pbmZvKHYpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aWYgKGRlYnVnLl9zb3VyY2UpXG5cdFx0e1xuXHRcdFx0dG9rZW5fYWRkX2luZm8oZGVidWcuX3NvdXJjZSk7XG5cdFx0fVxuXHR9XG5cblx0aWYgKHYpXG5cdHtcblx0XHRzb3J0T2JqZWN0S2V5cyh2LCB7XG5cdFx0XHRrZXlzOiBbXG5cdFx0XHRcdCd3Jyxcblx0XHRcdFx0J3AnLFxuXHRcdFx0XHQnZicsXG5cblx0XHRcdFx0J3BzJyxcblx0XHRcdFx0J3BwJyxcblxuXHRcdFx0XHQnb3cnLFxuXHRcdFx0XHQnb3AnLFxuXHRcdFx0XHQnb3BzJyxcblx0XHRcdFx0J29wcCcsXG5cblx0XHRcdFx0J29zJyxcblx0XHRcdF0sXG5cblx0XHRcdHVzZVNvdXJjZTogdHJ1ZSxcblx0XHR9KTtcblx0fVxuXG5cdHJldHVybiB2O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9IZXgocDogbnVtYmVyKVxue1xuXHRyZXR1cm4gJzB4JyArIHBcblx0XHQudG9TdHJpbmcoMTYpXG5cdFx0LnBhZFN0YXJ0KDQsICcwJylcblx0XHQudG9VcHBlckNhc2UoKVxuXHRcdDtcbn1cblxuXG4iXX0=