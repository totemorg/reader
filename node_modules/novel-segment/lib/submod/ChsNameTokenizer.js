'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * 中文人名识别模块
 *
 * @author 老雷<leizongmin@gmail.com>
 */
const CHS_NAMES_1 = require("../mod/CHS_NAMES");
const mod_1 = require("../mod");
class ChsNameTokenizer extends mod_1.SubSModuleTokenizer {
    constructor() {
        super(...arguments);
        this.name = 'ChsNameTokenizer';
    }
    _cache() {
        super._cache();
        this._TABLE = this.segment.getDict('TABLE');
        this._POSTAG = this.segment.POSTAG;
    }
    /**
     * 对未识别的单词进行分词
     *
     * @param {array} words 单词数组
     * @return {array}
     */
    split(words) {
        const POSTAG = this._POSTAG;
        let ret = [];
        for (let i = 0, word; word = words[i]; i++) {
            if (word.p) {
                // 仅对未识别的词进行匹配
                ret.push(word);
                continue;
            }
            let nameinfo = this.matchName(word.w);
            if (nameinfo.length < 1) {
                ret.push(word);
                continue;
            }
            // 分离出人名
            let lastc = 0;
            for (let ui = 0, url; url = nameinfo[ui]; ui++) {
                if (url.c > lastc) {
                    ret.push(this.debugToken({
                        w: word.w.substr(lastc, url.c - lastc),
                    }, {
                        [this.name]: false,
                    }, true));
                }
                ret.push(this.debugToken({
                    w: url.w,
                    p: POSTAG.A_NR
                }, {
                    [this.name]: true,
                }, true));
                lastc = url.c + url.w.length;
            }
            let lastn = nameinfo[nameinfo.length - 1];
            if (lastn.c + lastn.w.length < word.w.length) {
                ret.push(this.debugToken({
                    w: word.w.substr(lastn.c + lastn.w.length),
                }, {
                    [this.name]: false,
                }, true));
            }
        }
        return ret;
    }
    /**
     * 匹配包含的人名，并返回相关信息
     *
     * @param {string} text 文本
     * @param {int} cur 开始位置
     * @return {array}  返回格式   {w: '人名', c: 开始位置}
     */
    matchName(text, cur = 0) {
        if (isNaN(cur))
            cur = 0;
        let ret = [];
        while (cur < text.length) {
            //debug('cur=' + cur + ', ' + text.charAt(cur));
            let name = null;
            // 复姓
            let f2 = text.substr(cur, 2);
            if (f2 in CHS_NAMES_1.FAMILY_NAME_2) {
                let n1 = text.charAt(cur + 2);
                let n2 = text.charAt(cur + 3);
                if (n1 in CHS_NAMES_1.DOUBLE_NAME_1 && n2 in CHS_NAMES_1.DOUBLE_NAME_2) {
                    name = f2 + n1 + n2;
                }
                else if (n1 in CHS_NAMES_1.SINGLE_NAME) {
                    name = f2 + n1 + (n1 == n2 ? n2 : '');
                }
            }
            // 单姓
            let f1 = text.charAt(cur);
            if (name === null && f1 in CHS_NAMES_1.FAMILY_NAME_1) {
                let n1 = text.charAt(cur + 1);
                let n2 = text.charAt(cur + 2);
                if (n1 in CHS_NAMES_1.DOUBLE_NAME_1 && n2 in CHS_NAMES_1.DOUBLE_NAME_2) {
                    name = f1 + n1 + n2;
                }
                else if (n1 in CHS_NAMES_1.SINGLE_NAME) {
                    name = f1 + n1 + (n1 == n2 ? n2 : '');
                }
            }
            // 检查是否匹配成功
            if (name === null) {
                cur++;
            }
            else {
                ret.push({ w: name, c: cur });
                cur += name.length;
            }
        }
        return ret;
    }
}
exports.ChsNameTokenizer = ChsNameTokenizer;
// ======================================================================
// debug(matchName('刘德华和李娜娜、司马光、上官飞飞'));
// debug(matchName('李克'));
exports.init = ChsNameTokenizer.init.bind(ChsNameTokenizer);
exports.default = ChsNameTokenizer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2hzTmFtZVRva2VuaXplci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkNoc05hbWVUb2tlbml6ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDOztBQUViOzs7O0dBSUc7QUFFSCxnREFBc0g7QUFFdEgsZ0NBQXlEO0FBS3pELE1BQWEsZ0JBQWlCLFNBQVEseUJBQW1CO0lBQXpEOztRQUtDLFNBQUksR0FBRyxrQkFBa0IsQ0FBQztJQStIM0IsQ0FBQztJQTdIQSxNQUFNO1FBRUwsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBRWYsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM1QyxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDO0lBQ3BDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILEtBQUssQ0FBQyxLQUFjO1FBRW5CLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDNUIsSUFBSSxHQUFHLEdBQVksRUFBRSxDQUFDO1FBRXRCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUMxQztZQUNDLElBQUksSUFBSSxDQUFDLENBQUMsRUFDVjtnQkFDQyxjQUFjO2dCQUNkLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ2YsU0FBUzthQUNUO1lBQ0QsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEMsSUFBSSxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsRUFDdkI7Z0JBQ0MsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDZixTQUFTO2FBQ1Q7WUFDRCxRQUFRO1lB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cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIOS4reaWh+S6uuWQjeivhuWIq+aooeWdl1xuICpcbiAqIEBhdXRob3Ig6ICB6Zu3PGxlaXpvbmdtaW5AZ21haWwuY29tPlxuICovXG5cbmltcG9ydCBDSFNfTkFNRVMsIHsgRkFNSUxZX05BTUVfMSwgRkFNSUxZX05BTUVfMiwgU0lOR0xFX05BTUUsIERPVUJMRV9OQU1FXzEsIERPVUJMRV9OQU1FXzIgfSBmcm9tICcuLi9tb2QvQ0hTX05BTUVTJztcbmltcG9ydCB7IGRlYnVnIH0gZnJvbSAnLi4vdXRpbCc7XG5pbXBvcnQgeyBTdWJTTW9kdWxlLCBTdWJTTW9kdWxlVG9rZW5pemVyIH0gZnJvbSAnLi4vbW9kJztcbmltcG9ydCB7IFNlZ21lbnQsIElXb3JkLCBJRElDVCwgSURJQ1RfU1lOT05ZTSB9IGZyb20gJy4uL1NlZ21lbnQnO1xuLy8gQHRzLWlnbm9yZVxuaW1wb3J0IHsgVVN0cmluZyB9IGZyb20gJ3VuaS1zdHJpbmcnO1xuXG5leHBvcnQgY2xhc3MgQ2hzTmFtZVRva2VuaXplciBleHRlbmRzIFN1YlNNb2R1bGVUb2tlbml6ZXJcbntcblxuXHRwcm90ZWN0ZWQgX1RBQkxFOiBJRElDVDxJV29yZD47XG5cblx0bmFtZSA9ICdDaHNOYW1lVG9rZW5pemVyJztcblxuXHRfY2FjaGUoKVxuXHR7XG5cdFx0c3VwZXIuX2NhY2hlKCk7XG5cblx0XHR0aGlzLl9UQUJMRSA9IHRoaXMuc2VnbWVudC5nZXREaWN0KCdUQUJMRScpO1xuXHRcdHRoaXMuX1BPU1RBRyA9IHRoaXMuc2VnbWVudC5QT1NUQUc7XG5cdH1cblxuXHQvKipcblx0ICog5a+55pyq6K+G5Yir55qE5Y2V6K+N6L+b6KGM5YiG6K+NXG5cdCAqXG5cdCAqIEBwYXJhbSB7YXJyYXl9IHdvcmRzIOWNleivjeaVsOe7hFxuXHQgKiBAcmV0dXJuIHthcnJheX1cblx0ICovXG5cdHNwbGl0KHdvcmRzOiBJV29yZFtdKTogSVdvcmRbXVxuXHR7XG5cdFx0Y29uc3QgUE9TVEFHID0gdGhpcy5fUE9TVEFHO1xuXHRcdGxldCByZXQ6IElXb3JkW10gPSBbXTtcblxuXHRcdGZvciAobGV0IGkgPSAwLCB3b3JkOyB3b3JkID0gd29yZHNbaV07IGkrKylcblx0XHR7XG5cdFx0XHRpZiAod29yZC5wKVxuXHRcdFx0e1xuXHRcdFx0XHQvLyDku4Xlr7nmnKror4bliKvnmoTor43ov5vooYzljLnphY1cblx0XHRcdFx0cmV0LnB1c2god29yZCk7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXHRcdFx0bGV0IG5hbWVpbmZvID0gdGhpcy5tYXRjaE5hbWUod29yZC53KTtcblx0XHRcdGlmIChuYW1laW5mby5sZW5ndGggPCAxKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXQucHVzaCh3b3JkKTtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cdFx0XHQvLyDliIbnprvlh7rkurrlkI1cblx0XHRcdGxldCBsYXN0YyA9IDA7XG5cdFx0XHRmb3IgKGxldCB1aSA9IDAsIHVybDsgdXJsID0gbmFtZWluZm9bdWldOyB1aSsrKVxuXHRcdFx0e1xuXHRcdFx0XHRpZiAodXJsLmMgPiBsYXN0Yylcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHJldC5wdXNoKHRoaXMuZGVidWdUb2tlbih7XG5cdFx0XHRcdFx0XHR3OiB3b3JkLncuc3Vic3RyKGxhc3RjLCB1cmwuYyAtIGxhc3RjKSxcblx0XHRcdFx0XHR9LCB7XG5cdFx0XHRcdFx0XHRbdGhpcy5uYW1lXTogZmFsc2UsXG5cdFx0XHRcdFx0fSwgdHJ1ZSkpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0LnB1c2godGhpcy5kZWJ1Z1Rva2VuKHtcblx0XHRcdFx0XHR3OiB1cmwudyxcblx0XHRcdFx0XHRwOiBQT1NUQUcuQV9OUlxuXHRcdFx0XHR9LCB7XG5cdFx0XHRcdFx0W3RoaXMubmFtZV06IHRydWUsXG5cdFx0XHRcdH0sIHRydWUpKTtcblx0XHRcdFx0bGFzdGMgPSB1cmwuYyArIHVybC53Lmxlbmd0aDtcblx0XHRcdH1cblx0XHRcdGxldCBsYXN0biA9IG5hbWVpbmZvW25hbWVpbmZvLmxlbmd0aCAtIDFdO1xuXHRcdFx0aWYgKGxhc3RuLmMgKyBsYXN0bi53Lmxlbmd0aCA8IHdvcmQudy5sZW5ndGgpXG5cdFx0XHR7XG5cdFx0XHRcdHJldC5wdXNoKHRoaXMuZGVidWdUb2tlbih7XG5cdFx0XHRcdFx0dzogd29yZC53LnN1YnN0cihsYXN0bi5jICsgbGFzdG4udy5sZW5ndGgpLFxuXHRcdFx0XHR9LCB7XG5cdFx0XHRcdFx0W3RoaXMubmFtZV06IGZhbHNlLFxuXHRcdFx0XHR9LCB0cnVlKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXQ7XG5cdH1cblxuXHQvKipcblx0ICog5Yy56YWN5YyF5ZCr55qE5Lq65ZCN77yM5bm26L+U5Zue55u45YWz5L+h5oGvXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IOaWh+acrFxuXHQgKiBAcGFyYW0ge2ludH0gY3VyIOW8gOWni+S9jee9rlxuXHQgKiBAcmV0dXJuIHthcnJheX0gIOi/lOWbnuagvOW8jyAgIHt3OiAn5Lq65ZCNJywgYzog5byA5aeL5L2N572ufVxuXHQgKi9cblx0bWF0Y2hOYW1lKHRleHQ6IHN0cmluZywgY3VyOiBudW1iZXIgPSAwKTogSVdvcmRbXVxuXHR7XG5cdFx0aWYgKGlzTmFOKGN1cikpIGN1ciA9IDA7XG5cdFx0bGV0IHJldDogSVdvcmRbXSA9IFtdO1xuXHRcdHdoaWxlIChjdXIgPCB0ZXh0Lmxlbmd0aClcblx0XHR7XG5cdFx0XHQvL2RlYnVnKCdjdXI9JyArIGN1ciArICcsICcgKyB0ZXh0LmNoYXJBdChjdXIpKTtcblx0XHRcdGxldCBuYW1lOiBzdHJpbmcgPSBudWxsO1xuXHRcdFx0Ly8g5aSN5aeTXG5cdFx0XHRsZXQgZjIgPSB0ZXh0LnN1YnN0cihjdXIsIDIpO1xuXHRcdFx0aWYgKGYyIGluIEZBTUlMWV9OQU1FXzIpXG5cdFx0XHR7XG5cdFx0XHRcdGxldCBuMSA9IHRleHQuY2hhckF0KGN1ciArIDIpO1xuXHRcdFx0XHRsZXQgbjIgPSB0ZXh0LmNoYXJBdChjdXIgKyAzKTtcblx0XHRcdFx0aWYgKG4xIGluIERPVUJMRV9OQU1FXzEgJiYgbjIgaW4gRE9VQkxFX05BTUVfMilcblx0XHRcdFx0e1xuXHRcdFx0XHRcdG5hbWUgPSBmMiArIG4xICsgbjI7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSBpZiAobjEgaW4gU0lOR0xFX05BTUUpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRuYW1lID0gZjIgKyBuMSArIChuMSA9PSBuMiA/IG4yIDogJycpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQvLyDljZXlp5Ncblx0XHRcdGxldCBmMSA9IHRleHQuY2hhckF0KGN1cik7XG5cdFx0XHRpZiAobmFtZSA9PT0gbnVsbCAmJiBmMSBpbiBGQU1JTFlfTkFNRV8xKVxuXHRcdFx0e1xuXHRcdFx0XHRsZXQgbjEgPSB0ZXh0LmNoYXJBdChjdXIgKyAxKTtcblx0XHRcdFx0bGV0IG4yID0gdGV4dC5jaGFyQXQoY3VyICsgMik7XG5cdFx0XHRcdGlmIChuMSBpbiBET1VCTEVfTkFNRV8xICYmIG4yIGluIERPVUJMRV9OQU1FXzIpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRuYW1lID0gZjEgKyBuMSArIG4yO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgaWYgKG4xIGluIFNJTkdMRV9OQU1FKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0bmFtZSA9IGYxICsgbjEgKyAobjEgPT0gbjIgPyBuMiA6ICcnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Ly8g5qOA5p+l5piv5ZCm5Yy56YWN5oiQ5YqfXG5cdFx0XHRpZiAobmFtZSA9PT0gbnVsbClcblx0XHRcdHtcblx0XHRcdFx0Y3VyKys7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHJldC5wdXNoKHsgdzogbmFtZSwgYzogY3VyIH0pO1xuXHRcdFx0XHRjdXIgKz0gbmFtZS5sZW5ndGg7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXQ7XG5cdH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLyBkZWJ1ZyhtYXRjaE5hbWUoJ+WImOW+t+WNjuWSjOadjuWonOWonOOAgeWPuOmprOWFieOAgeS4iuWumOmjnumjnicpKTtcbi8vIGRlYnVnKG1hdGNoTmFtZSgn5p2O5YWLJykpO1xuXG5leHBvcnQgY29uc3QgaW5pdCA9IENoc05hbWVUb2tlbml6ZXIuaW5pdC5iaW5kKENoc05hbWVUb2tlbml6ZXIpIGFzIHR5cGVvZiBDaHNOYW1lVG9rZW5pemVyLmluaXQ7XG5cbmV4cG9ydCBkZWZhdWx0IENoc05hbWVUb2tlbml6ZXI7XG4iXX0=