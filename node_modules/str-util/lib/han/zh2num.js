"use strict";
/**
 * Created by user on 2017/12/11/011.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const chinese_parseInt = require("chinese-parseint");
const japanese = require("japanese");
exports.defaultOptions = {
    one: true,
};
exports.transcriptionConfigs = japanese.transcriptionConfigs;
exports.predefineedTranscriptionConfigs = japanese.predefineedTranscriptionConfigs;
function zh2num(str, options = {}) {
    options = Object.assign({}, exports.defaultOptions, options);
    let sa = [];
    let do_def = true;
    let jtc = japanese.transcriptionConfigs;
    let jpc = japanese.predefineedTranscriptionConfigs;
    for (let id of [
        'digits',
        'unitNames',
    ]) {
        if (Array.isArray(options[id]) && options[id].length) {
            for (let d of options[id]) {
                if (jpc[id][d]) {
                    sa = sa.concat(Object.values(jpc[id][d]));
                }
            }
        }
    }
    if (typeof options.truncateOne == 'number') {
        for (let i in jtc.default.truncateOne) {
            // @ts-ignore
            if (i < options.truncateOne) {
                sa.push(jtc.default.truncateOne[i]);
            }
        }
    }
    else if ((typeof options.truncateOne == 'undefined' || options.truncateOne === true) && sa.length) {
        sa = sa.concat(Object.values(jtc.default.truncateOne));
    }
    if (options.chars) {
        sa = sa.concat(Array.isArray(options.chars) ? options.chars : options.chars.split(''));
    }
    if (sa.length) {
        do_def = false;
    }
    sa.filter(function (value) {
        if (value.length == 1 && (value in chinese_parseInt.characters)) {
            return true;
        }
        return false;
    });
    if (do_def) {
        sa = Object.keys(chinese_parseInt.characters);
    }
    options.flags = (options.flags || 'u');
    if (options.unsafe) {
        options.flags = (options.flags || '') + 'g';
    }
    //console.log(options, sa);
    let rs = sa.join('');
    let s = str.toString();
    if (!(new RegExp('([^' + rs + '])')).test(s)) {
        return _chinese_parseInt(s, options);
    }
    else if (options.strict) {
        return Number.NaN;
    }
    let r = new RegExp('([' + rs + ']+)', options.flags);
    return s.replace(r, function (...m) {
        return _chinese_parseInt(m[1], options);
    }).toString();
}
exports.zh2num = zh2num;
function _chinese_parseInt(str, options = {}) {
    if (options.one) {
        str = str.replace(/([佰百])([一二三四五六七八九壹貳參肆伍陸柒捌玖])(?![零○〇一二三四五六七八九壹貳參肆伍陸柒捌玖拾十什])/, '$1〇$2');
    }
    let ret = chinese_parseInt(str);
    if (options.string) {
        ret = ret.toString();
    }
    return ret;
}
exports._chinese_parseInt = _chinese_parseInt;
/**
 * 將數字轉為漢字
 *
 * @param number
 * @param options
 * @returns {string}
 *
 * @example num2zh(1117) == '千百十七'
 */
function num2zh(number, options = {}) {
    let d = parseInt(number);
    if (Number.isNaN(d) || (options && options.strict && (typeof number != 'number' || d !== number))) {
        throw new TypeError(`${number} is not valid allow number`);
    }
    return japanese.transcribeNumber(d, options);
}
exports.num2zh = num2zh;
exports.default = exports;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiemgybnVtLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiemgybnVtLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFFSCxxREFBc0Q7QUFDdEQscUNBQXNDO0FBaUN6QixRQUFBLGNBQWMsR0FBRztJQUM3QixHQUFHLEVBQUUsSUFBSTtDQUNHLENBQUM7QUFFRCxRQUFBLG9CQUFvQixHQUFHLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQztBQUVyRCxRQUFBLCtCQUErQixHQUFHLFFBQVEsQ0FBQywrQkFBK0IsQ0FBQztBQWN4RixTQUFnQixNQUFNLENBQUMsR0FBRyxFQUFFLFVBQW9CLEVBQUU7SUFFakQsT0FBTyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLHNCQUFjLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFFckQsSUFBSSxFQUFFLEdBQWEsRUFBRSxDQUFDO0lBQ3RCLElBQUksTUFBTSxHQUFHLElBQUksQ0FBQztJQUVsQixJQUFJLEdBQUcsR0FBRyxRQUFRLENBQUMsb0JBQW9CLENBQUM7SUFDeEMsSUFBSSxHQUFHLEdBQUcsUUFBUSxDQUFDLCtCQUErQixDQUFDO0lBRW5ELEtBQUssSUFBSSxFQUFFLElBQUk7UUFDZCxRQUFRO1FBQ1IsV0FBVztLQUNYLEVBQ0Q7UUFDQyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sRUFDcEQ7WUFDQyxLQUFLLElBQUksQ0FBQyxJQUFJLE9BQU8sQ0FBQyxFQUFFLENBQUMsRUFDekI7Z0JBQ0MsSUFBSSxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQ2Q7b0JBQ0MsRUFBRSxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2lC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QWdCLGlCQUFpQixDQUFDLEdBQVcsRUFBRSxVQUFvQixFQUFFO0lBRXBFLElBQUksT0FBTyxDQUFDLEdBQUcsRUFDZjtRQUNDLEdBQUcsR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLDREQUE0RCxFQUFFLE9BQU8sQ0FBQyxDQUFDO0tBQ3pGO0lBRUQsSUFBSSxHQUFHLEdBQUcsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLENBQUM7SUFFaEMsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUNsQjtRQUNDLEdBQUcsR0FBRyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUM7S0FDckI7SUFFRCxPQUFPLEdBQUcsQ0FBQztBQUNaLENBQUM7QUFmRCw4Q0FlQztBQUVEOzs7Ozs7OztHQVFHO0FBQ0gsU0FBZ0IsTUFBTSxDQUFDLE1BQU0sRUFBRSxVQUFlLEVBQUU7SUFFL0MsSUFBSSxDQUFDLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRXpCLElBQUksTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sSUFBSSxPQUFPLENBQUMsTUFBTSxJQUFJLENBQUMsT0FBTyxNQUFNLElBQUksUUFBUSxJQUFJLENBQUMsS0FBSyxNQUFNLENBQUMsQ0FBQyxFQUNqRztRQUNDLE1BQU0sSUFBSSxTQUFTLENBQUMsR0FBRyxNQUFNLDRCQUE0QixDQUFDLENBQUM7S0FDM0Q7SUFFRCxPQUFPLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDOUMsQ0FBQztBQVZELHdCQVVDO0FBRUQsa0JBQWUsT0FBb0MsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSB1c2VyIG9uIDIwMTcvMTIvMTEvMDExLlxuICovXG5cbmltcG9ydCBjaGluZXNlX3BhcnNlSW50ID0gcmVxdWlyZSgnY2hpbmVzZS1wYXJzZWludCcpO1xuaW1wb3J0IGphcGFuZXNlID0gcmVxdWlyZSgnamFwYW5lc2UnKTtcblxuZXhwb3J0IGludGVyZmFjZSBJT3B0aW9uc1xue1xuXHQvKipcblx0ICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vaGFrYXRhc2hpL2phcGFuZXNlLmpzL2Jsb2IvbWFzdGVyL3NyYy9udW1iZXJzLmVzNlxuIFx0ICovXG5cdGRpZ2l0cz86IHN0cmluZ1tdO1xuXHQvKipcblx0ICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vaGFrYXRhc2hpL2phcGFuZXNlLmpzL2Jsb2IvbWFzdGVyL3NyYy9udW1iZXJzLmVzNlxuXHQgKi9cblx0dW5pdE5hbWVzPzogc3RyaW5nW107XG5cblx0LyoqXG5cdCAqIHJlcGxhY2UgYWxsXG5cdCAqL1xuXHR1bnNhZmU/OiBib29sZWFuO1xuXHQvKipcblx0ICogUmVnRXhwIEZsYWdzXG5cdCAqL1xuXHRmbGFncz86IHN0cmluZztcblxuXHRjaGFycz86IHN0cmluZztcblxuXHR0cnVuY2F0ZU9uZT86IG51bWJlciB8IGJvb2xlYW47XG5cblx0c3RyaWN0PzogYm9vbGVhbjtcblxuXHRvbmU/OiBib29sZWFuO1xuXG5cdHN0cmluZz86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcblx0b25lOiB0cnVlLFxufSBhcyBJT3B0aW9ucztcblxuZXhwb3J0IGNvbnN0IHRyYW5zY3JpcHRpb25Db25maWdzID0gamFwYW5lc2UudHJhbnNjcmlwdGlvbkNvbmZpZ3M7XG5cbmV4cG9ydCBjb25zdCBwcmVkZWZpbmVlZFRyYW5zY3JpcHRpb25Db25maWdzID0gamFwYW5lc2UucHJlZGVmaW5lZWRUcmFuc2NyaXB0aW9uQ29uZmlncztcblxuLyoqXG4gKiDlsIfmvKLlrZfovYnmj5vmiJDmlbjlrZdcbiAqIFBhcnNlIENoaW5lc2UvSmFwYW5lc2UgbnVtZXJpYyBzdHJpbmdzIHRvIGludGVnZXJcbiAqXG4gKiBAcGFyYW0gc3RyXG4gKiBAcGFyYW0ge0lPcHRpb25zfSBvcHRpb25zXG4gKiBAcmV0dXJucyB7c3RyaW5nfG51bWJlcn1cbiAqXG4gKiBAZXhhbXBsZSB6aDJudW0oJ+WNg+eZvuWNgeS4gycpID09IDExMTdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHpoMm51bShzdHIsIG9wdGlvbnM/OiBJT3B0aW9ucyk6IHN0cmluZ1xuZXhwb3J0IGZ1bmN0aW9uIHpoMm51bShzdHI6IG51bWJlciwgb3B0aW9ucz86IElPcHRpb25zKTogbnVtYmVyXG5leHBvcnQgZnVuY3Rpb24gemgybnVtKHN0ciwgb3B0aW9uczogSU9wdGlvbnMgPSB7fSlcbntcblx0b3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuXHRsZXQgc2E6IHN0cmluZ1tdID0gW107XG5cdGxldCBkb19kZWYgPSB0cnVlO1xuXG5cdGxldCBqdGMgPSBqYXBhbmVzZS50cmFuc2NyaXB0aW9uQ29uZmlncztcblx0bGV0IGpwYyA9IGphcGFuZXNlLnByZWRlZmluZWVkVHJhbnNjcmlwdGlvbkNvbmZpZ3M7XG5cblx0Zm9yIChsZXQgaWQgb2YgW1xuXHRcdCdkaWdpdHMnLFxuXHRcdCd1bml0TmFtZXMnLFxuXHRdKVxuXHR7XG5cdFx0aWYgKEFycmF5LmlzQXJyYXkob3B0aW9uc1tpZF0pICYmIG9wdGlvbnNbaWRdLmxlbmd0aClcblx0XHR7XG5cdFx0XHRmb3IgKGxldCBkIG9mIG9wdGlvbnNbaWRdKVxuXHRcdFx0e1xuXHRcdFx0XHRpZiAoanBjW2lkXVtkXSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHNhID0gc2EuY29uY2F0KE9iamVjdC52YWx1ZXMoanBjW2lkXVtkXSkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aWYgKHR5cGVvZiBvcHRpb25zLnRydW5jYXRlT25lID09ICdudW1iZXInKVxuXHR7XG5cdFx0Zm9yIChsZXQgaSBpbiBqdGMuZGVmYXVsdC50cnVuY2F0ZU9uZSlcblx0XHR7XG5cdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRpZiAoaSA8IG9wdGlvbnMudHJ1bmNhdGVPbmUpXG5cdFx0XHR7XG5cdFx0XHRcdHNhLnB1c2goanRjLmRlZmF1bHQudHJ1bmNhdGVPbmVbaV0pXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdGVsc2UgaWYgKCh0eXBlb2Ygb3B0aW9ucy50cnVuY2F0ZU9uZSA9PSAndW5kZWZpbmVkJyB8fCBvcHRpb25zLnRydW5jYXRlT25lID09PSB0cnVlKSAmJiBzYS5sZW5ndGgpXG5cdHtcblx0XHRzYSA9IHNhLmNvbmNhdChPYmplY3QudmFsdWVzKGp0Yy5kZWZhdWx0LnRydW5jYXRlT25lKSk7XG5cdH1cblxuXHRpZiAob3B0aW9ucy5jaGFycylcblx0e1xuXHRcdHNhID0gc2EuY29uY2F0KEFycmF5LmlzQXJyYXkob3B0aW9ucy5jaGFycykgPyBvcHRpb25zLmNoYXJzIDogb3B0aW9ucy5jaGFycy5zcGxpdCgnJykpO1xuXHR9XG5cblx0aWYgKHNhLmxlbmd0aClcblx0e1xuXHRcdGRvX2RlZiA9IGZhbHNlO1xuXHR9XG5cblx0c2EuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSlcblx0e1xuXHRcdGlmICh2YWx1ZS5sZW5ndGggPT0gMSAmJiAodmFsdWUgaW4gY2hpbmVzZV9wYXJzZUludC5jaGFyYWN0ZXJzKSlcblx0XHR7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0pO1xuXG5cdGlmIChkb19kZWYpXG5cdHtcblx0XHRzYSA9IE9iamVjdC5rZXlzKGNoaW5lc2VfcGFyc2VJbnQuY2hhcmFjdGVycyk7XG5cdH1cblxuXHRvcHRpb25zLmZsYWdzID0gKG9wdGlvbnMuZmxhZ3MgfHwgJ3UnKTtcblxuXHRpZiAob3B0aW9ucy51bnNhZmUpXG5cdHtcblx0XHRvcHRpb25zLmZsYWdzID0gKG9wdGlvbnMuZmxhZ3MgfHwgJycpICsgJ2cnO1xuXHR9XG5cblx0Ly9jb25zb2xlLmxvZyhvcHRpb25zLCBzYSk7XG5cblx0bGV0IHJzID0gc2Euam9pbignJyk7XG5cblx0bGV0IHMgPSBzdHIudG9TdHJpbmcoKTtcblxuXHRpZiAoIShuZXcgUmVnRXhwKCcoW14nICsgcnMgKyAnXSknKSkudGVzdChzKSlcblx0e1xuXHRcdHJldHVybiBfY2hpbmVzZV9wYXJzZUludChzLCBvcHRpb25zKSBhcyBudW1iZXI7XG5cdH1cblx0ZWxzZSBpZiAob3B0aW9ucy5zdHJpY3QpXG5cdHtcblx0XHRyZXR1cm4gTnVtYmVyLk5hTjtcblx0fVxuXG5cdGxldCByID0gbmV3IFJlZ0V4cCgnKFsnICsgcnMgKyAnXSspJywgb3B0aW9ucy5mbGFncyk7XG5cblx0cmV0dXJuIHMucmVwbGFjZShyLCBmdW5jdGlvbiAoLi4ubSlcblx0e1xuXHRcdHJldHVybiBfY2hpbmVzZV9wYXJzZUludChtWzFdLCBvcHRpb25zKTtcblx0fSkudG9TdHJpbmcoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9jaGluZXNlX3BhcnNlSW50KHN0cjogc3RyaW5nLCBvcHRpb25zOiBJT3B0aW9ucyA9IHt9KVxue1xuXHRpZiAob3B0aW9ucy5vbmUpXG5cdHtcblx0XHRzdHIgPSBzdHIucmVwbGFjZSgvKFvkvbDnmb5dKShb5LiA5LqM5LiJ5Zub5LqU5YWt5LiD5YWr5Lmd5aO56LKz5Y+D6IKG5LyN6Zm45p+S5o2M546WXSkoPyFb6Zu24peL44CH5LiA5LqM5LiJ5Zub5LqU5YWt5LiD5YWr5Lmd5aO56LKz5Y+D6IKG5LyN6Zm45p+S5o2M546W5ou+5Y2B5LuAXSkvLCAnJDHjgIckMicpO1xuXHR9XG5cblx0bGV0IHJldCA9IGNoaW5lc2VfcGFyc2VJbnQoc3RyKTtcblxuXHRpZiAob3B0aW9ucy5zdHJpbmcpXG5cdHtcblx0XHRyZXQgPSByZXQudG9TdHJpbmcoKTtcblx0fVxuXG5cdHJldHVybiByZXQ7XG59XG5cbi8qKlxuICog5bCH5pW45a2X6L2J54K65ryi5a2XXG4gKlxuICogQHBhcmFtIG51bWJlclxuICogQHBhcmFtIG9wdGlvbnNcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKlxuICogQGV4YW1wbGUgbnVtMnpoKDExMTcpID09ICfljYPnmb7ljYHkuIMnXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBudW0yemgobnVtYmVyLCBvcHRpb25zOiBhbnkgPSB7fSk6IHN0cmluZ1xue1xuXHRsZXQgZCA9IHBhcnNlSW50KG51bWJlcik7XG5cblx0aWYgKE51bWJlci5pc05hTihkKSB8fCAob3B0aW9ucyAmJiBvcHRpb25zLnN0cmljdCAmJiAodHlwZW9mIG51bWJlciAhPSAnbnVtYmVyJyB8fCBkICE9PSBudW1iZXIpKSlcblx0e1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoYCR7bnVtYmVyfSBpcyBub3QgdmFsaWQgYWxsb3cgbnVtYmVyYCk7XG5cdH1cblxuXHRyZXR1cm4gamFwYW5lc2UudHJhbnNjcmliZU51bWJlcihkLCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZXhwb3J0cyBhcyB0eXBlb2YgaW1wb3J0KCcuL3poMm51bScpO1xuIl19